$(document).ready(function() {
    function n(t) {
        return t.replace(/(\[|\]|:|\.)/g, "\\$1")
    }($(".chzn-select").chosen({
        width: "300px"
    }), $("a.aios-remove-zone").on("click", function() {
        var t = $(this).attr("title");
        return !("" != t && !confirm(t))
    }), $("span.aios-editable").each(function() {
        "" == $(this).html() && $(this).html("<em>null</em>")
    }), $("span.aios-editable").each(function() {
        $(this).attr("title", "Click to edit")
    }).on("click", function() {
        var t = $(this).html();
        "<em>null</em>" == t && (t = "");
        var e = $(this).attr("name"),
            n = $(this).attr("class"),
            a = document.createElement("input");
        $(a).attr({
            type: "text",
            value: t
        }).addClass(n), $(a).attr("name", e), $(this).hasClass("aios-number") && $(a).attr("size", "7"), $(this).hasClass("aios-text") && $(a).attr("size", "25"), $(this).replaceWith(a)
    }), $("body").on("change", "input.aios-editable", function() {
        var t = $(this).parents("tr:first").find('input[name^="update_rates"]');
        $(t).val(1)
    }), $("a.aios-edit").on("click", function() {
        var t = $(this).parents("tr:first").find("span.aios-editable");
        return $(t).click(), t = $(this).parents("tr:first").find("input.aios-editable"), $(t).data("original", $(t).val()), !1
    }), $("tr.aios-add-rates-row").hide(), $("a.aios-add").on("click", function() {
        var t = $(this).parents("tbody:first").find("tr:last");
        if ($(t).is(":visible")) {
            for (var e = $(t).html(), n = 1; n <= 5; n++) {
                var a = e.replace(/\]\[(\d+)\]/g, function(t, e) {
                    return new_index = parseInt(e, 10) + n, "][" + new_index + "]"
                });
                $(this).parents("tbody:first").append("<tr>" + a + "</tr>")
            }
            $(".list").find("tbody>tr:nth-child(even)").addClass("list-even"), $(".list").find("tbody>tr:nth-child(odd)").addClass("list-odd")
        } else $(this).parents("tbody:first").find("tr.aios-add-rates-row").show();
        return !1
    }), $("a.aios-remove").on("click", function() {
        var t = $(this).attr("rel"),
            e = $("input[name=" + n(t) + "]");
        return $(e).val(1), e = $(this).parents("tr:first"), $(e).addClass("show-removed"), e = $(this).parents("td").children("a.aios-undo-remove"), $(e).show(), $(this).hide(), !1
    }), $("a.aios-undo-remove").on("click", function() {
        var t = $(this).attr("rel"),
            e = $("input[name=" + n(t) + "]");
        return $(e).val(0), e = $(this).parents("tr:first"), $(e).removeClass("show-removed"), e = $(this).parents("td").children("a.aios-remove"), $(e).show(), $(this).hide(), !1
    }), $("a.aios-undo-remove").hide(), $("input.max-weight").on("change", function() {
        var t = $(this).parents("tr:first").next().find("input.min-weight");
        t && ($(t).val($(this).val()), $(t).stop().css("background-color", "#FFFF00").animate({
            backgroundColor: "#FFFFFF"
        }, 500))
    }), $("input.max-value").on("change", function() {
        var t = $(this).parents("tr:first").next().find("input.min-value");
        t && ($(t).val($(this).val()), $(t).stop().css("background-color", "#FFFF00").animate({
            backgroundColor: "#FFFFFF"
        }, 500))
    }), $("input.max-items").on("change", function() {
        var t = $(this).parents("tr:first").next().find("input.min-items");
        t && ($(t).val(parseInt($(this).val()) + 1), $(t).stop().css("background-color", "#FFFF00").animate({
            backgroundColor: "#FFFFFF"
        }, 500))
    }), $("#chzn-state-country").change(function() {
        t($(this).find(":selected").attr("data-country-id"))
    }), 0 < $("#chzn-state-country").length) && t($("#chzn-state-country").find(":selected").attr("data-country-id"));

    function t(t) {
        if($('#zone_type_states:checked').length === 0) return false;
        var module_folder = $("div#page_content form div:first-child").attr("id");
        $.getJSON("?_g=plugins&type=shipping&module="+module_folder+"&action=ajax&country_id=" + t, function(t) {
            var a = $(".chzn-select");
            a.empty();
            var i = 0;
            $.each(t, function(t, e) {
                i++;
                var n = 0 <= selected_states.indexOf(e.abbrev) ? ' selected="selected"' : "";
                a.append('<option value="' + e.abbrev + '"' + n + ">" + e.name + "</option>")
            }), 0 == i ? alert("No states are defined for that country.") : $(".chzn-select").trigger("chosen:updated")
        })
    }
});